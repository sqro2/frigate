function scope_id(e){for(var t="";t.length<e&&e>0;){var r=Math.random();t+=.1>r?Math.floor(100*r):String.fromCharCode(Math.floor(26*r)+(r>.5?97:65))}return t}function str_concat(e,t){var r=" ";for(j=0;t>j;j++)r+=e;return r}function g_collect(){preprocessor.lex_table=null,preprocessor.lex_table={},$index=0,$loop_index=void 0,$multiplier=0,$scope_array=["global"],$current_scope_index_pointer=0,$lex_table_length=0,$current_lex_row=void 0,$code_gen.result.string_gen=""}var i,n,p,j,$scope_id,$scope_state_current,$index=0,$loop_index,$multiplier=0,$scope_array=["global"],$current_scope_index_pointer=0,$lex_table_length=0,$current_lex_row,$selector,$code_gen={init:function(){for(p=0;$lex_table_length>p;p++){var e=preprocessor.lex_table["row"+p],t=e.multiplier_c,r=e.scope_c+"*",i=e.scope_c+"[*]",l=new RegExp(i,"g"),s="<"+e.token_c+' id="'+e.id+'" class="'+e.clss+'">'+e.id_c+"* </"+e.token_c+">";if("global"===e.scope_c)if(0!==t){var n=str_concat(s,t);this.result.string_gen=this.result.string_gen+n}else this.result.string_gen=this.result.string_gen+s;else if(0!==t){var n=str_concat(s,t);this.result.string_gen=this.result.string_gen.replace(l,n+r)}else this.result.string_gen=this.result.string_gen.replace(l,s+r)}return this.fprocess(this.result.string_gen)},result:{string_gen:""},fprocess:function(e){var t=e.replace(/>\w*\d*[*]/gi,">"),r=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return g_collect(),r}},preprocessor={init:function(e){var t=e.replace(/\s\s*/g," "),r=t.replace(/\s*{\s*/gi," { "),i=r.replace(/\s*}\s*/gi," } "),l=i.replace(/\s*\)\s*/gi," ) "),s=l.replace(/\s*\(\s*/gi," ( ");this.attr_stack.id_stack=s.match(/#(.*?)\s/gi),this.attr_stack.class_stack=s.match(/\.(.*?)\s/gi);var n=s.replace(/#(.*?)\s/gi," id "),c=n.replace(/\.(.*?)\s/gi," class "),_=c.replace(/\(|\)/gi,""),a=_.replace(/#+|\.+/gi,""),o=a.replace(/\s*[*]\s*/gi," * "),p=o.split(" "),g=p.toString(),u=g.replace(/,,/gi,","),x=u.split(",");return""===x[x.length-1]?(x.pop(),this.lex_table_init(x),$code_gen.init()):(this.lex_table_init(x),$code_gen.init())},lex_table_init:function(e){for(i=0;i<e.length;i++)null==e[i].match(/^[0-9]+$/g)&&""!==e[i]&&(void 0!==e[i+1]&&void 0!==e[i-1]?this.lex_table_constrc(e[i],e[i+1],e[i-1]):this.lex_table_constrc(e[i],"null","null"))},lex_table_constrc:function(e,t,r){switch(e){case"{":$scope_array.push($scope_state_current),$current_scope_index_pointer++;break;case"}":$current_scope_index_pointer--,$scope_array.pop();break;case"*":if("null"!==t&&t.match(/^[0-9]+$/g)){if($token_multiplier=parseInt(t),"}"!==r&&(this.lex_table[$current_lex_row].multiplier_c=$token_multiplier),"}"===r){var i=$scope_array[$current_scope_index_pointer];for(n=0;$lex_table_length>n;n++)if(this.lex_table["row"+n].scope_c===i)var l="row"+n;this.lex_table[l].multiplier_c=$token_multiplier}}else alert("error in parsing multiplier");break;case"class":var i=$scope_array[$current_scope_index_pointer];for(n=0;$lex_table_length>n;n++)if(this.lex_table["row"+n].scope_c===i)var l="row"+n;var s=this.attr_stack.class_stack.shift(),c=s.replace(".","");this.lex_table[l].clss=c.replace(/\s*/gi,"");break;case"id":var i=$scope_array[$current_scope_index_pointer];for(n=0;$lex_table_length>n;n++)if(this.lex_table["row"+n].scope_c===i)var l="row"+n;var _=this.attr_stack.id_stack.shift(),a=_.replace("#","");this.lex_table[l].id=a.replace(/\s*/gi,"");break;default:this.lex_table["row"+$index]=new Object;var o=scope_id(8);this.lex_table["row"+$index].id_c=o,this.lex_table["row"+$index].clss="null",this.lex_table["row"+$index].id="null",this.lex_table["row"+$index].token_c=e,this.lex_table["row"+$index].scope_c=$scope_array[$current_scope_index_pointer],this.lex_table["row"+$index].multiplier_c=$multiplier,$current_lex_row="row"+$index,$index+=1,$lex_table_length+=1,$scope_state_current=o}},lex_table:{},attr_stack:{}};!function(e){e.fn.toHtml=function(e){var t=this.val(),r=preprocessor.init(t);e(r)}}(jQuery);